<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css">
        body{
            font-size: 14px;
        }
        div{
            padding: 5px;
            margin: 5px;
        }
        span{
            margin: 4px;
            width: 100px;
            display: inline-block;
        }
        .header{
            background-color: #CCCCCC;
        }
        #userlist{
            width: 600px;
            border: 1px darkblue solid;
        }
        #userlist div{
            border-bottom: 1px darkblue solid;
        }

    </style>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(function () {
            //初始化调用查询所有用户
            getuser();
            //定义查询用户的方法
            function getuser(){
                var username=$("#username").val();
                //页面加载调用Ajax
                $.ajax({
                    url:"userList",
                    dataType:"json",
                    data:{username:username},
                    success:function (data) {
                        var arr=data.list;
                        //alert(arr.length);
                        for(var i=0;i<arr.length;i++){
                            var u=arr[i];
                            var id=u.id;
                            var username=u.username;
                            var password=u.password;
                            var content=" <div>\n" +
                                "        <span>"+username+"</span>\n" +
                                "        <span>"+password+"</span>\n" +
                                "        <span>\n" +
                                "            <button>查询</button>\n" +
                                "            <button rel='"+id+"' class='delete'>删除</button>\n" +
                                "        </span>\n" +
                                "    </div>";
                            $("#userlist").append(content);
                        }


                    }
                })
            }
            //按钮事件
            $("button").click(function () {
                var username=$("#username").val();
                //清空原来数据
                $("#userlist .header").siblings().remove();
                getuser();
            })

            //点击删除事件
            // $(".delete").click(function () {
            //     alert("点击删除")
            // })

            $("#userlist").delegate(".delete","click",function () {
                var id=$(this).attr("rel");
                $(this).parent().parent().remove();
                //同步数据库
                $.ajax({
                    url:"userDelete",
                    data:{id:id},
                    dataType:"json",
                    success:function (data) {
                        alert("删除成功");
                    }
                })
            })
        })
    </script>

</head>
<body>
<h2>用户列表</h2>
<div id="search">
    <input id="username" type="text" placeholder="请输入用户名"/>
    <span><button>查询</button></span>
</div>
<div id="userlist">
    <div class="header">
        <span>用户名</span>
        <span>密码</span>
        <span>操作</span>
    </div>


</div>
</body>
</html>